<% layout('layouts/boilerplate') -%>
<div id="viewBody">
    <div id="container">
        <img id="viewImg" src="<%= listing.image %>" alt="">
        <br>
        <div id="about">
            <a style="text-decoration: none; color: white;" href="/listings">
                <button style="padding: 0.3em; padding-top: 0; padding-bottom: 0;" id="close" class="red">x</button>
            </a>
            <br>
            <b>
                <span style="font-size: 30px; width: min-content;"><%= listing.title %></span>
            </b>
            <br>
            <i style="font-size: small;">owned by : <%= listing.owner.username %></i>
            <% if (user && user.equals(listing.owner)) { %>
                (You)
            <% } %>
            <br>
            <br>
            <p style="max-height: 6.25rem; overflow-y: scroll; scrollbar-width: none;"><%= listing.description %></p>
            <br>
            <br>
            <b>Price : </b>&#8377;<i><%= listing.price.toLocaleString('en-IN'); %></i> / night
            <br>
            <br>
            <b>Location : </b><i><%= listing.location %></i>
            <br>
            <br>
            <b>Country : </b><i><%= listing.country %></i>
            <br>
            <br>
            <% if (user && user._id.equals(listing.owner._id)) { %>
                <div id="btns">
                    <a id="edit" class="Btn an" href="http://localhost:3000/listings/<%= listing._id %>/edit">Edit</a>
                    <button id="delete" class="btn red">Delete</button>
                </div>
            <% } %> 
        </div>
    </div>
    <form id="delReq" style="display: none;" method="post" action="http://localhost:3000/listings/<%= listing._id %>?_method=DELETE">
        <button class="delReq"></button>
    </form>   
    <hr>

    <div class="reviews">
        <%- include('../includes/viewReviews.ejs') %>
        <%- include('../includes/leaveReview.ejs') %>
    </div>
    
</div>